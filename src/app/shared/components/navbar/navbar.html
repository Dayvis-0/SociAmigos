<nav class="navbar">
  <div class="navbar-left">
    <a routerLink="/feed" class="logo-link">
      <div class="app-logo">üåê</div>
    </a>
    <div class="search-container" [class.open]="searchOpen">
      <div class="search-input-wrapper">
        <span class="search-icon-inline">üîç</span>
        <input 
          type="text" 
          class="search-input"
          placeholder="Buscar en SociAmigos"
          [(ngModel)]="searchQuery"
        >
      </div>
      <button 
        class="search-toggle" 
        (click)="toggleSearch()"
        aria-label="Abrir b√∫squeda"
      >
        üîç
      </button>
    </div>
  </div>
  
  <div class="navbar-center-home">
    <a routerLink="/feed" routerLinkActive="active" class="nav-center-home-item">
      <span>üè†</span>
      <span class="nav-center-home-text">Inicio</span>
    </a>
    <a routerLink="/friends" routerLinkActive="active" class="nav-center-home-item">
      <span>üë•</span>
      <span class="nav-center-home-text">Amigos</span>
    </a>
  </div>
  
  <div class="navbar-right">
    <!-- NOTIFICATION BELL -->
    <div class="notification-container">
      <div 
        class="notification-btn" 
        (click)="toggleNotifications()"
        [class.has-unread]="unreadCount > 0"
      >
        <span class="notification-icon">üîî</span>
        <span class="notification-badge" *ngIf="unreadCount > 0">
          {{ unreadCount > 9 ? '9+' : unreadCount }}
        </span>
      </div>
      
      <!-- NOTIFICATIONS DROPDOWN -->
      <div class="notifications-dropdown" [class.show]="notificationsOpen">
        <div class="notifications-header">
          <h3>Notificaciones</h3>
          <button 
            class="mark-all-read-btn" 
            *ngIf="unreadCount > 0"
            (click)="markAllAsRead()"
          >
            Marcar todas como le√≠das
          </button>
        </div>
        
        <div class="notifications-list">
          <div 
            *ngFor="let notification of notifications"
            class="notification-item"
            [class.unread]="!notification.read"
            (click)="handleNotificationClick(notification)"
          >
            <div class="notification-avatar">
              <div 
                class="avatar-circle"
                [style.background-image]="notification.fromUserPhotoURL ? 'url(' + notification.fromUserPhotoURL + ')' : 'none'"
              >
                <span *ngIf="!notification.fromUserPhotoURL">
                  {{ getInitials(notification.fromUserName) }}
                </span>
              </div>
              <span class="notification-type-icon">
                {{ getNotificationIcon(notification.type) }}
              </span>
            </div>
            
            <div class="notification-content">
              <p class="notification-message">{{ notification.message }}</p>
              <span class="notification-time">{{ getTimeAgo(notification) }}</span>
              
              <!-- FRIEND REQUEST ACTIONS -->
              <div 
                class="notification-actions" 
                *ngIf="notification.type === 'friend_request' && notification.friendshipId"
              >
                <button 
                  class="btn-accept"
                  (click)="acceptFriendRequest(notification, $event)"
                  [disabled]="loadingNotification === notification.notificationId"
                >
                  {{ loadingNotification === notification.notificationId ? 'Procesando...' : 'Aceptar' }}
                </button>
                <button 
                  class="btn-reject"
                  (click)="rejectFriendRequest(notification, $event)"
                  [disabled]="loadingNotification === notification.notificationId"
                >
                  Rechazar
                </button>
              </div>
            </div>
            
            <div class="unread-dot" *ngIf="!notification.read"></div>
          </div>
          
          <!-- EMPTY STATE -->
          <div class="notifications-empty" *ngIf="notifications.length === 0">
            <span class="empty-icon">üîî</span>
            <p>No tienes notificaciones</p>
          </div>
        </div>
      </div>
    </div>
    
    <!-- USER MENU -->
    <div class="user-menu-container">
      <div 
        class="user-avatar-nav" 
        (click)="toggleUserMenu()"
        [title]="currentUser?.displayName || 'Usuario'"
      >
        {{ userInitials }}
      </div>
      
      <div class="user-dropdown-menu" [class.show]="userMenuOpen">
        <div class="user-menu-header" *ngIf="currentUser">
          <div class="user-menu-avatar">{{ userInitials }}</div>
          <div class="user-menu-info">
            <div class="user-menu-name">{{ currentUser.displayName }}</div>
            <div class="user-menu-email">{{ currentUser.email }}</div>
          </div>
        </div>
        
        <div class="user-menu-divider"></div>
        
        <a 
          routerLink="/profile" 
          class="user-menu-item" 
          (click)="closeUserMenu()"
        >
          <span>üë§</span>
          <span>Ver perfil</span>
        </a>
        
        <a 
          routerLink="/profile/edit" 
          class="user-menu-item" 
          (click)="closeUserMenu()"
        >
          <span>‚öôÔ∏è</span>
          <span>Configuraci√≥n</span>
        </a>
        
        <div class="user-menu-divider"></div>
        
        <a 
          href="javascript:void(0)" 
          class="user-menu-item logout-item" 
          (click)="logout()"
        >
          <span>üö™</span>
          <span>Cerrar sesi√≥n</span>
        </a>
      </div>
    </div>
  </div>
</nav>